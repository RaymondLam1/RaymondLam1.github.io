(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{591:function(t,a,v){"use strict";v.r(a);var _=v(2),e=Object(_.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[t._v("#")]),t._v(" 背景")]),t._v(" "),a("p",[t._v("防痴呆文章")]),t._v(" "),a("p",[t._v("JFR：https://docs.oracle.com/en/java/java-components/jdk-mission-control/8/user-guide/using-jdk-flight-recorder.html")]),t._v(" "),a("p",[t._v("JMC：打开 JFR 的图形化工具")]),t._v(" "),a("h2",{attrs:{id:"工具准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#工具准备"}},[t._v("#")]),t._v(" 工具准备")]),t._v(" "),a("h3",{attrs:{id:"java"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#java"}},[t._v("#")]),t._v(" Java")]),t._v(" "),a("p",[t._v("Java 17 环境：https://sdkman.io/")]),t._v(" "),a("blockquote",[a("p",[t._v("强烈推荐，最好用的  Java 环境配置工具")])]),t._v(" "),a("h3",{attrs:{id:"jmc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jmc"}},[t._v("#")]),t._v(" JMC")]),t._v(" "),a("ul",[a("li",[t._v("8.31 下载：https://www.oracle.com/java/technologies/javase/products-jmc8-downloads.html")]),t._v(" "),a("li",[t._v("9.* 下载：https://www.oracle.com/java/technologies/javase/products-jmc9-downloads.html")])]),t._v(" "),a("blockquote",[a("p",[t._v("推荐使用 9 版本")])]),t._v(" "),a("p",[t._v("mac 系统直接打开 JMC，会报错，原因是 JMC 的 Java 环境配置不正确，需要在 "),a("code",[t._v("/Contents/Eclipse/jmc.ini")]),t._v(" 配置文件增加 -vm 参数指定 Java 17 环境：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("-startup\n../Eclipse/plugins/org.eclipse.equinox.launcher_1.6.600.v20231106-1826.jar\n--launcher.library\n../Eclipse/plugins/org.eclipse.equinox.launcher.cocoa.macosx.x86_64_1.2.800.v20231003-1442\n--launcher.appendVmargs\n-ws\ncocoa\n-vm\n/Users/raymond/.sdkman/candidates/java/17.0.11-zulu/zulu-17.jdk/Contents/Home/bin\n-vmargs\n-XX:+IgnoreUnrecognizedVMOptions\n-XX:+UnlockDiagnosticVMOptions\n-XX:+DebugNonSafepoints\n-XX:FlightRecorderOptions=stackdepth=128\n-XX:+FlightRecorder\n-XX:StartFlightRecording=name=JMC_Default,maxsize=100m\n-Djava.net.preferIPv4Stack=true\n-Djdk.attach.allowAttachSelf=true\n--add-exports=java.xml/com.sun.org.apache.xerces.internal.parsers=ALL-UNNAMED\n--add-exports=jdk.internal.jvmstat/sun.jvmstat.monitor=ALL-UNNAMED\n--add-exports=java.management/sun.management=ALL-UNNAMED\n--add-exports=java.management/sun.management.counter.perf=ALL-UNNAMED\n--add-exports=jdk.management.agent/jdk.internal.agent=ALL-UNNAMED\n--add-exports=jdk.attach/sun.tools.attach=ALL-UNNAMED\n--add-opens=java.base/java.net=ALL-UNNAMED\n--add-opens=jdk.attach/sun.tools.attach=ALL-UNNAMED\n-Dsun.java.command=JMC\n--add-exports=java.desktop/sun.lwawt.macosx=ALL-UNNAMED\n-XstartOnFirstThread\n-Dorg.eclipse.swt.internal.carbon.smallFonts\n")])])]),a("h2",{attrs:{id:"jcmd-采集-jfr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jcmd-采集-jfr"}},[t._v("#")]),t._v(" jcmd 采集 JFR")]),t._v(" "),a("h3",{attrs:{id:"检查是否支持-jfr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#检查是否支持-jfr"}},[t._v("#")]),t._v(" 检查是否支持 JFR")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:+UnlockExperimentalVMOptions")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:+PrintFlagsFinal")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-version")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" FlightRecorder\n")])])]),a("h3",{attrs:{id:"启动-jfr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动-jfr"}},[t._v("#")]),t._v(" 启动 JFR")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("jcmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("PID"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" JFR.start "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("delay")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("10s "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("duration")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("10m "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("filename")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("recording.jfr "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("settings")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("profile\n")])])]),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("描述")]),t._v(" "),a("th",[t._v("数据类型")]),t._v(" "),a("th",[t._v("默认值")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("name")]),t._v(" "),a("td",[t._v("记录的名称")]),t._v(" "),a("td",[t._v("字符串")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("设置")]),t._v(" "),a("td",[t._v("服务器端模板")]),t._v(" "),a("td",[t._v("字符串")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("duration")]),t._v(" "),a("td",[t._v("记录持续时间")]),t._v(" "),a("td",[t._v("Time")]),t._v(" "),a("td",[t._v("0s")])]),t._v(" "),a("tr",[a("td",[t._v("filename")]),t._v(" "),a("td",[t._v("生成记录文件名")]),t._v(" "),a("td",[t._v("字符串")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("maxAge")]),t._v(" "),a("td",[t._v("缓冲数据的最长期限")]),t._v(" "),a("td",[t._v("Time")]),t._v(" "),a("td",[t._v("0s")])]),t._v(" "),a("tr",[a("td",[t._v("maxsize")]),t._v(" "),a("td",[t._v("缓冲区的最大大小（以字节为单位）")]),t._v(" "),a("td",[t._v("Long")]),t._v(" "),a("td",[t._v("0")])]),t._v(" "),a("tr",[a("td",[t._v("dumponexit")]),t._v(" "),a("td",[t._v("JVM 关闭时运行的转储记录")]),t._v(" "),a("td",[t._v("布尔值")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("path-to-gc-roots")]),t._v(" "),a("td",[t._v("收集垃圾收集器 root 的路径")]),t._v(" "),a("td",[t._v("布尔值")]),t._v(" "),a("td",[t._v("False")])]),t._v(" "),a("tr",[a("td",[t._v("Settings")]),t._v(" "),a("td",[t._v("记录事件的细粒度")]),t._v(" "),a("td",[t._v("字符串")]),t._v(" "),a("td",[t._v("Default")])])])]),t._v(" "),a("h3",{attrs:{id:"检查-jfr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#检查-jfr"}},[t._v("#")]),t._v(" 检查 JFR")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("jcmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("PID"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" JFR.check\n")])])]),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("描述")]),t._v(" "),a("th",[t._v("数据类型")]),t._v(" "),a("th",[t._v("默认值")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("name")]),t._v(" "),a("td",[t._v("记录的名称")]),t._v(" "),a("td",[t._v("字符串")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("filename")]),t._v(" "),a("td",[t._v("将记录数据复制到文件中")]),t._v(" "),a("td",[t._v("字符串")]),t._v(" "),a("td",[t._v("-")])])])]),t._v(" "),a("h3",{attrs:{id:"停止-jfr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#停止-jfr"}},[t._v("#")]),t._v(" 停止 JFR")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("jcmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("PID"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" JFR.stop "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("output_file\n")])])]),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("描述")]),t._v(" "),a("th",[t._v("数据类型")]),t._v(" "),a("th",[t._v("默认值")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("name")]),t._v(" "),a("td",[t._v("记录的名称")]),t._v(" "),a("td",[t._v("字符串")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("filename")]),t._v(" "),a("td",[t._v("将记录数据复制到文件中")]),t._v(" "),a("td",[t._v("字符串")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("maxAge")]),t._v(" "),a("td",[t._v("转储文件的最大持续时间")]),t._v(" "),a("td",[t._v("Time")]),t._v(" "),a("td",[t._v("0s")])]),t._v(" "),a("tr",[a("td",[t._v("maxsize")]),t._v(" "),a("td",[t._v("转储的最大字节数")]),t._v(" "),a("td",[t._v("Long")]),t._v(" "),a("td",[t._v("0")])]),t._v(" "),a("tr",[a("td",[t._v("begin")]),t._v(" "),a("td",[t._v("开始转储数据的时间")]),t._v(" "),a("td",[t._v("字符串")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("end")]),t._v(" "),a("td",[t._v("转储数据的结束时间")]),t._v(" "),a("td",[t._v("字符串")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("path-to-gc-roots")]),t._v(" "),a("td",[t._v("收集垃圾收集器 root 的路径")]),t._v(" "),a("td",[t._v("布尔值")]),t._v(" "),a("td",[t._v("false")])])])]),t._v(" "),a("h3",{attrs:{id:"dump-jfr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dump-jfr"}},[t._v("#")]),t._v(" dump JFR")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("jcmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("PID"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" JFR.dump "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("output_file "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("filename")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("output.jfr\n")])])]),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("描述")]),t._v(" "),a("th",[t._v("数据类型")]),t._v(" "),a("th",[t._v("默认值")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("name")]),t._v(" "),a("td",[t._v("记录的名称")]),t._v(" "),a("td",[t._v("字符串")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("filename")]),t._v(" "),a("td",[t._v("将记录数据复制到文件中")]),t._v(" "),a("td",[t._v("字符串")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("maxAge")]),t._v(" "),a("td",[t._v("转储文件的最大持续时间")]),t._v(" "),a("td",[t._v("Time")]),t._v(" "),a("td",[t._v("0s")])]),t._v(" "),a("tr",[a("td",[t._v("maxsize")]),t._v(" "),a("td",[t._v("转储的最大字节数")]),t._v(" "),a("td",[t._v("Long")]),t._v(" "),a("td",[t._v("0")])]),t._v(" "),a("tr",[a("td",[t._v("begin")]),t._v(" "),a("td",[t._v("开始转储数据的时间")]),t._v(" "),a("td",[t._v("字符串")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("end")]),t._v(" "),a("td",[t._v("转储数据的结束时间")]),t._v(" "),a("td",[t._v("字符串")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("path-to-gc-roots")]),t._v(" "),a("td",[t._v("收集垃圾收集器 root 的路径")]),t._v(" "),a("td",[t._v("布尔值")]),t._v(" "),a("td",[t._v("false")])])])]),t._v(" "),a("h3",{attrs:{id:"配置-jfr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置-jfr"}},[t._v("#")]),t._v(" 配置 JFR")]),t._v(" "),a("p",[t._v("使用 "),a("code",[t._v("JFR.configure")]),t._v(" 诊断命令配置 flight 记录。例如：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("jcmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("PID"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" JFR.configure "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("repositorypath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/home/jfr/recordings\n")])])]),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("描述")]),t._v(" "),a("th",[t._v("数据类型")]),t._v(" "),a("th",[t._v("默认值")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("repositorypath")]),t._v(" "),a("td",[t._v("到仓库的路径")]),t._v(" "),a("td",[t._v("字符串")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("dumppath")]),t._v(" "),a("td",[t._v("转储的路径")]),t._v(" "),a("td",[t._v("字符串")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("stackdepth")]),t._v(" "),a("td",[t._v("堆栈深度")]),t._v(" "),a("td",[t._v("Jlong")]),t._v(" "),a("td",[t._v("64")])]),t._v(" "),a("tr",[a("td",[t._v("globalbuffercount")]),t._v(" "),a("td",[t._v("全局缓冲区数")]),t._v(" "),a("td",[t._v("Jlong")]),t._v(" "),a("td",[t._v("32")])]),t._v(" "),a("tr",[a("td",[t._v("globalbuffersize")]),t._v(" "),a("td",[t._v("全局缓冲区的大小")]),t._v(" "),a("td",[t._v("Jlong")]),t._v(" "),a("td",[t._v("524288")])]),t._v(" "),a("tr",[a("td",[t._v("thread_buffer_size")]),t._v(" "),a("td",[t._v("线程缓冲的大小")]),t._v(" "),a("td",[t._v("Jlong")]),t._v(" "),a("td",[t._v("8192")])]),t._v(" "),a("tr",[a("td",[t._v("memorysize")]),t._v(" "),a("td",[t._v("总内存大小")]),t._v(" "),a("td",[t._v("Jlong")]),t._v(" "),a("td",[t._v("16777216")])]),t._v(" "),a("tr",[a("td",[t._v("maxchunksize")]),t._v(" "),a("td",[t._v("单个磁盘块的大小")]),t._v(" "),a("td",[t._v("Jlong")]),t._v(" "),a("td",[t._v("12582912")])]),t._v(" "),a("tr",[a("td",[t._v("Samplethreads")]),t._v(" "),a("td",[t._v("激活线程抽样")]),t._v(" "),a("td",[t._v("布尔值")]),t._v(" "),a("td",[t._v("true")])])])]),t._v(" "),a("h2",{attrs:{id:"命令行采集-jfr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令行采集-jfr"}},[t._v("#")]),t._v(" 命令行采集 JFR")]),t._v(" "),a("blockquote",[a("p",[t._v("挺少用到的。如果应用程序启动失败，却有找不到解决思路，可以采集下启动时的 JFR")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:StartFlightRecording")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("delay"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("5s,disk"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("false,dumponexit"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true,duration"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("60s,filename"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("myrecording.jfr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v("YOUR_JAVA_APPLICATION"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v("\n")])])]),a("p",[a("strong",[t._v("delay=time")])]),t._v(" "),a("p",[t._v("使用此参数指定 Java 应用程序启动时间和记录开始之间的延迟。附加 s 以指定时间（以秒为单位）、m 表示分钟、h 表示小时或 d 表示天。例如，指定 10m 表示 10 分钟。默认情况下，没有延迟，此参数被设为 0。")]),t._v(" "),a("p",[a("strong",[t._v("disk={true|false}")])]),t._v(" "),a("p",[t._v("使用此参数指定在记录时是否将数据写入磁盘。默认情况下，此参数为 "),a("code",[t._v("true")]),t._v("。")]),t._v(" "),a("p",[a("strong",[t._v("dumponexit={true|false}")])]),t._v(" "),a("p",[t._v("使用此参数指定在 JVM 关闭时是否转储正在运行的记录。如果启用了该参数且未设置文件名，则记录将写入到启动记录进度的目录中的文件。文件名是系统生成的名称，其中包含进程 ID、记录 ID 和当前时间戳。例如，hotspot-pid-47496-id-1-2018_01_25_19_10_41.jfr。默认情况下，此参数为 "),a("code",[t._v("false")]),t._v("。")]),t._v(" "),a("p",[a("strong",[t._v("duration=time")])]),t._v(" "),a("p",[t._v("使用此参数指定记录的持续时间。附加 s 以指定时间（以秒为单位）、m 表示分钟、h 表示小时或 d 表示天。例如，如果您将持续时间指定为 5h，这表示 5 小时。默认情况下，此参数被设置为 0，这意味着记录持续时间中没有设置限制。")]),t._v(" "),a("p",[a("strong",[t._v("filename=path")])]),t._v(" "),a("p",[t._v("使用此参数指定记录文件的路径和名称。记录会在停止时写入此文件。例如：")]),t._v(" "),a("p",[t._v("records.jfr")]),t._v(" "),a("p",[t._v("· /home/user/recordings/recording.jfr")]),t._v(" "),a("p",[a("strong",[t._v("name=identifier")])]),t._v(" "),a("p",[t._v("使用此参数指定记录的名称和标识符。")]),t._v(" "),a("p",[a("strong",[t._v("maxAge=time")])]),t._v(" "),a("p",[t._v("使用此参数指定在磁盘上应提供记录的最大天数。只有 disk 参数设置为 true 时，此参数才有效。附加 s 以指定时间（以秒为单位）、m 表示分钟、h 表示小时或 d 表示天。例如，当您指定 30s 时，它表示 30 秒。默认情况下，此参数被设置为 0，这意味着没有设置限制。")]),t._v(" "),a("p",[a("strong",[t._v("maxsize=size")])]),t._v(" "),a("p",[t._v("使用此参数指定要为记录保留的最大磁盘数据大小。只有 disk 参数设置为 true 时，此参数才有效。该值不能小于使用 "),a("code",[t._v("-XX:FlightRecorderOptions")]),t._v(" 设置的 "),a("code",[t._v("maxchunksize")]),t._v(" 参数的值。附加 m 或 M 以指定大小（以 MB 为单位），或者 g 或 G 以指定大小（以 GB 为单位）。默认情况下，磁盘数据的最大大小没有限制，此参数被设置为 0。")]),t._v(" "),a("p",[a("strong",[t._v("path-to-gc-roots={true|false}")])]),t._v(" "),a("p",[t._v("使用此参数指定在记录末尾是否收集垃圾回收(GC) root 的路径。默认情况下，此参数被设置为 false。")]),t._v(" "),a("p",[t._v("GC root 的路径对于查找内存泄漏非常有用。对于红帽构建的 OpenJDK 17，您可以启用 "),a("code",[t._v("OldObjectSample")]),t._v(" 事件，该事件比使用堆转储更高效。您还可以在生产环境中使用 "),a("code",[t._v("OldObjectSample")]),t._v(" 事件。收集内存泄漏信息会非常耗时，并会产生额外的开销。只有在您开始记录您怀疑有内存泄漏的应用程序时，才应启用此参数。如果 JFR 配置集参数设置为 profile，您可以跟踪对象泄漏的堆栈。它包含在收集的信息中。")]),t._v(" "),a("p",[a("strong",[t._v("settings=path")])]),t._v(" "),a("p",[t._v("使用此参数指定事件设置文件的路径和名称（类型为 JFC）。默认情况下，使用 default.jfc 文件，该文件位于 JAVA_HOME/lib/jfr 中。此默认设置文件收集一组预定义的开销信息，因此对性能的影响最少，并可与持续运行的记录一起使用。第二个设置文件也会提供 profile.jfc，它提供比默认配置更多的数据，但可能会有更多的开销和影响性能。当需要更多信息时，请使用此配置短时间。")]),t._v(" "),a("h2",{attrs:{id:"参考文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[t._v("#")]),t._v(" 参考文档：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("https://docs.oracle.com/en/java/java-components/jdk-mission-control/8/user-guide/using-jdk-flight-recorder.html")])]),t._v(" "),a("li",[a("p",[t._v("https://docs.redhat.com/zh_hans/documentation/red_hat_build_of_openjdk/17/html/using_jdk_flight_recorder_with_red_hat_build_of_openjdk/")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);